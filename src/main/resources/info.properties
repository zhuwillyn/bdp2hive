partition_script=sh ${sqoop_path}/sqoop import -Dorg.apache.sqoop.splitter.allow_text_splitter=true --connect 'jdbc:mysql://${ip}:${port}/${database}?useUnicode=true&characterEncoding=UTF-8' --username ${username} --password ${password} --target-dir /tmp/${hdfs_path} --query '${sql} where 1=1 and $CONDITIONS' --hive-import --hive-database ${hive_database} --hive-table ${hive_table} --fields-terminated-by '^' --hive-partition-key SJYYLJGDM_PARTITION --hive-partition-value ${partition_value} --num-mappers 1 --as-textfile\n

sqoop.ref.sql=SELECT b.medical_org_name,b.medical_org_code,c.database_name,c.database_address,c.access_port,c.user_name,c.password,d.table_name,e.field_name,f.dataset_item_code,g.dataset_struc_code FROM t_dc_ref a,t_ds_org b,t_ds_database c,t_ds_table d,t_ds_tablefield e,t_dataset_item f, t_dataset_struc g WHERE a.fk_ds_id = e.id AND a.fk_dataset_item_id = f.id AND e.fk_belong_table = d.id AND d.fk_belong_datatable = c.id AND c.fk_belong_org = b.id AND f.fk_dataset_struc_id = g.id
sqoop.ref.sql.condition=AND b.medical_org_code IN (%s)
sqoop.item.sql=SELECT b.dataset_item_code FROM t_dataset_struc a, t_dataset_item b WHERE a.id = b.fk_dataset_struc_id AND dataset_struc_code = '%s'

log.ref.sql=SELECT b.medical_org_name,b.medical_org_code,c.database_name,c.database_address,c.access_port,c.user_name,c.password,d.table_name,g.dataset_struc_code FROM t_dc_ref a,t_ds_org b,t_ds_database c,t_ds_table d,t_ds_tablefield e,t_dataset_item f,t_dataset_struc g WHERE a.fk_ds_id = e.id AND a.fk_dataset_item_id = f.id AND e.fk_belong_table = d.id AND d.fk_belong_datatable = c.id AND c.fk_belong_org = b.id AND f.fk_dataset_struc_id = g.id GROUP BY b.medical_org_code,c.database_name,d.table_name,g.dataset_struc_code
log.count.sql=SELECT COUNT(1) FROM %s
log.create.sql=CREATE TABLE IF NOT EXISTS "cecd_his"."convert_hive_log" ("src_org_name" varchar(255) COLLATE "default","src_org_code" varchar(255) COLLATE "default","src_url" varchar(255) COLLATE "default","src_database" varchar(255) COLLATE "default","src_table" varchar(255) COLLATE "default","src_count" int8,"dst_url" varchar(255) COLLATE "default","dst_database" varchar(255) COLLATE "default","dst_table" varchar(255) COLLATE "default","dst_count" int8,"status" bit(2),"create_time" date DEFAULT ('now'::text)::timestamp without time zone) WITH (OIDS=FALSE)
log.insert.sql=INSERT INTO "cecd_his"."convert_hive_log" ("src_org_name", "src_org_code", "src_url", "src_database", "src_table", "src_count", "dst_url", "dst_database", "dst_table", "dst_count", "status", "create_time") VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, LOCALTIMESTAMP)